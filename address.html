<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title id="site-title">Contact Us - SIGNAL PREPARATORY SCHOOL</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
    <link rel="stylesheet" href="contacts.css">
</head>
<body>
    <!-- CMS Admin Button (visible when logged in) -->
    <a href="/admin/" class="cms-admin-btn" id="cmsAdminBtn" style="display: none;">
        <i class="fas fa-cog"></i> <span id="admin-btn-text">CMS Admin</span>
    </a>
    
    <nav class="navbar" id="navbar">
        <div class="logo-container">
            <img src="logo.png" alt="Logo" class="logo" id="main-logo">
            <div class="logo-text" id="school-name">SIGNAL PREPARATORY<br>SCHOOL</div>
        </div>
        
        <!-- Modern Hamburger Menu -->
        <div class="hamburger" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </div>

        <!-- Navbar Links -->
        <ul class="nav-links" id="navLinks">
            <li><a href="index.html" class="nav-item">Home</a></li>
            <li><a href="about.html" class="nav-item">About</a></li>
            <li><a href="projects.html" class="nav-item">Projects</a></li>
            <li><a href="address.html" class="nav-item">Contacts</a></li>
            <li><a href="donate.html" class="nav-item"><button class="donate-btn">Donate</button></a></li>
        </ul>
    </nav>
    
    <main class="contact-container">
        <div class="contact-header">
            <h1 id="contact-page-heading">Contact Us</h1>
            <p id="contact-page-subheading">We'd love to hear from you! Reach out to us for any inquiries or feedback.</p>
        </div>

        <div class="contact-content">
            <!-- Contact Information -->
            <div class="contact-info">
                <div class="info-item">
                    <i class="fas fa-map-marker-alt"></i>
                    <h3 id="contact-section-heading">Our Office</h3>
                    <p id="office-address">Loading address...</p>
                </div>
                <div class="info-item">
                    <i class="fas fa-phone-alt"></i>
                    <h3>Call Us</h3>
                    <p id="phone1">Loading phone...</p>
                    <p id="phone2">Loading phone...</p>
                </div>
                <div class="info-item">
                    <i class="fas fa-envelope"></i>
                    <h3>Email Us</h3>
                    <p id="email">Loading email...</p>
                </div>
                <div class="info-item">
                    <i class="fas fa-clock"></i>
                    <h3>Working Hours</h3>
                    <p id="working-hours">Loading hours...</p>
                </div>
            </div>

            <!-- Contact Form -->
            <div class="contact-form">
                <h2 id="form-heading">Send Us a Message</h2>
                <form action="#" method="post" netlify>
                    <div class="form-group">
                        <input type="text" name="name" placeholder="Your Name" required>
                    </div>
                    <div class="form-group">
                        <input type="email" name="email" placeholder="Your Email" required>
                    </div>
                    <div class="form-group">
                        <input type="text" name="subject" placeholder="Subject" required>
                    </div>
                    <div class="form-group">
                        <textarea name="message" placeholder="Your Message" required></textarea>
                    </div>
                    <button type="submit" class="submit-btn">Send Message</button>
                </form>
            </div>
        </div>

        <!-- Map Section -->
        <div class="map-section">
            <h2 id="map-heading">Find Us on the Map</h2>
            <iframe id="google-map" src="" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
        </div>
    </main>
    
    <footer class="footer">
        <div class="footer-container">
            <!-- Logo and School Name -->
            <div class="footer-column logo-column">
                <div class="logo-container">
                    <img src="logo.png" alt="Signal Preparatory School Logo" class="footer-logo" id="footer-logo">
                    <div class="footer-logo-text" id="footer-school-name">SIGNAL PREPARATORY<br>SCHOOL</div>
                </div>
                <p class="footer-text" id="footer-tagline">Mentoring a coexisting generation with creativity, innovation, and environmental respect.</p>
                <div class="social-icons" id="social-icons-container">
                    <!-- Social icons will be dynamically inserted here -->
                </div>
            </div>

            <!-- Quick Links -->
            <div class="footer-column">
                <h3 class="footer-heading" id="footer-links-heading">Quick Links</h3>
                <ul class="footer-links">
                    <li><a href="index.html" class="footer-link">Home</a></li>
                    <li><a href="about.html" class="footer-link">About</a></li>
                    <li><a href="projects.html" class="footer-link">Projects</a></li>
                    <li><a href="address.html" class="footer-link">Contacts</a></li>
                </ul>
            </div>

            <!-- Contact Information -->
            <div class="footer-column">
                <h3 class="footer-heading" id="contact-heading">Contact Us</h3>
                <p class="footer-text" id="footer-email">Email: loading...</p>
                <p class="footer-text" id="footer-phone1">Phone: loading...</p>
                <p class="footer-text" id="footer-phone2">Phone: loading...</p>
                <p class="footer-text" id="footer-address">Address: loading...</p>
            </div>
        </div>

        <!-- Footer Bottom Section -->
        <div class="footer-bottom">
            <p class="footer-copyright" id="copyright-text">Â© 2025 Signal Preparatory School. All Rights Reserved.</p>
            <p class="designer-credit" id="designer-credit">Designed by <a href="#" class="designer-link" id="designer-link">Mumbere Darius</a></p>
            <a href="/admin/" class="admin-link" id="admin-link-text">Admin Login</a>
        </div>
    </footer>

    <!-- Content Loading Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Skip if in admin interface
            if (window.location.pathname.includes('/admin/')) return;

            // Load content from JSON
            fetch('/src/data/contacts.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok');
                    }
                    return response.json();
                })
                .then(data => {
                    // Site-wide content
                    if (data.title) {
                        document.title = data.title;
                        document.getElementById('site-title').textContent = data.title;
                    }
                    if (data.school_name) {
                        document.getElementById('school-name').textContent = data.school_name;
                        document.getElementById('footer-school-name').textContent = data.school_name;
                    }
                    if (data.logo) {
                        document.getElementById('main-logo').src = data.logo;
                        document.getElementById('footer-logo').src = data.logo;
                    }
                    if (data.admin_text) {
                        document.getElementById('admin-btn-text').textContent = data.admin_text;
                        document.getElementById('admin-link-text').textContent = data.admin_text;
                    }

                    // Contact Page Header
                    if (data.contact_page_heading) {
                        document.getElementById('contact-page-heading').textContent = data.contact_page_heading;
                    }
                    if (data.contact_page_subheading) {
                        document.getElementById('contact-page-subheading').textContent = data.contact_page_subheading;
                    }

                    // Contact Information
                    if (data.contact_section_heading) {
                        document.getElementById('contact-section-heading').textContent = data.contact_section_heading;
                    }
                    if (data.office_address) {
                        document.getElementById('office-address').textContent = data.office_address;
                    }
                    if (data.phone1) {
                        document.getElementById('phone1').textContent = data.phone1;
                        document.getElementById('footer-phone1').textContent = `Phone: ${data.phone1}`;
                    }
                    if (data.phone2) {
                        document.getElementById('phone2').textContent = data.phone2;
                        document.getElementById('footer-phone2').textContent = `Phone: ${data.phone2}`;
                    }
                    if (data.email) {
                        document.getElementById('email').textContent = data.email;
                        document.getElementById('footer-email').textContent = `Email: ${data.email}`;
                    }
                    if (data.working_hours) {
                        document.getElementById('working-hours').textContent = data.working_hours;
                    }

                    // Map Section
                    if (data.map_heading) {
                        document.getElementById('map-heading').textContent = data.map_heading;
                    }
                    if (data.google_maps_url) {
                        document.getElementById('google-map').src = data.google_maps_url;
                    }

                    // Form Section
                    if (data.form_heading) {
                        document.getElementById('form-heading').textContent = data.form_heading;
                    }

                    // Footer Section
                    if (data.footer_tagline) {
                        document.getElementById('footer-tagline').textContent = data.footer_tagline;
                    }

                    // Social Links
                    if (data.social_links && Array.isArray(data.social_links)) {
                        const socialContainer = document.getElementById('social-icons-container');
                        socialContainer.innerHTML = '';
                        
                        data.social_links.forEach(link => {
                            const iconClass = getSocialIconClass(link.platform);
                            if (iconClass) {
                                const socialHTML = `
                                    <a href="${link.url}" target="_blank" rel="noopener noreferrer" class="social-icon">
                                        <i class="${iconClass}"></i>
                                    </a>
                                `;
                                socialContainer.innerHTML += socialHTML;
                            }
                        });
                    }

                    // Contact Information
                    if (data.contact_heading) {
                        document.getElementById('contact-heading').textContent = data.contact_heading;
                    }
                    if (data.address) {
                        document.getElementById('footer-address').textContent = `Address: ${data.address}`;
                    }

                    // Footer Bottom
                    if (data.copyright_text) {
                        document.getElementById('copyright-text').textContent = data.copyright_text;
                    }
                    if (data.designer_text) {
                        document.getElementById('designer-credit').textContent = data.designer_text;
                    }
                    if (data.designer_link) {
                        document.getElementById('designer-link').href = data.designer_link;
                    }
                    if (data.designer_name) {
                        document.getElementById('designer-link').textContent = data.designer_name;
                    }
                })
                .catch(error => {
                    console.error('Error loading contact content:', error);
                    loadFallbackContent();
                });

            function getSocialIconClass(platform) {
                if (!platform) return 'fas fa-share-alt';
                const platformLower = platform.toLowerCase();
                if (platformLower.includes('facebook')) return 'fab fa-facebook-f';
                if (platformLower.includes('twitter')) return 'fab fa-twitter';
                if (platformLower.includes('instagram')) return 'fab fa-instagram';
                if (platformLower.includes('youtube')) return 'fab fa-youtube';
                if (platformLower.includes('linkedin')) return 'fab fa-linkedin';
                if (platformLower.includes('tiktok')) return 'fab fa-tiktok';
                return 'fas fa-share-alt'; // default icon
            }

            function loadFallbackContent() {
                // Fallback content that matches the JSON structure
                const fallbackData = {
                    contact_page_heading: "Contact Us",
                    contact_page_subheading: "We'd love to hear from you! Reach out to us for any inquiries or feedback.",
                    contact_section_heading: "Our Office",
                    office_address: "Bwera, Kasese, Uganda",
                    phone1: "+256 775413318",
                    phone2: "+256 754406992",
                    email: "signalarts1@gmail.com",
                    working_hours: "Mon - Fri: 8:00 AM - 6:00 PM",
                    map_heading: "Find Us on the Map",
                    google_maps_url: "https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d15959.270490960082!2d29.752027881283723!3d0.03388170730054174!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x1761de4b94e8e959%3A0x746f3e2d97d78604!2sBwera!5e0!3m2!1sen!2sug!4v1742633850042!5m2!1sen!2sug",
                    form_heading: "Send Us a Message"
                };

                document.getElementById('contact-page-heading').textContent = fallbackData.contact_page_heading;
                document.getElementById('contact-page-subheading').textContent = fallbackData.contact_page_subheading;
                document.getElementById('contact-section-heading').textContent = fallbackData.contact_section_heading;
                document.getElementById('office-address').textContent = fallbackData.office_address;
                document.getElementById('phone1').textContent = fallbackData.phone1;
                document.getElementById('phone2').textContent = fallbackData.phone2;
                document.getElementById('email').textContent = fallbackData.email;
                document.getElementById('working-hours').textContent = fallbackData.working_hours;
                document.getElementById('map-heading').textContent = fallbackData.map_heading;
                document.getElementById('google-map').src = fallbackData.google_maps_url;
                document.getElementById('form-heading').textContent = fallbackData.form_heading;
            }

            // Modern toggle menu with animation
            const hamburger = document.getElementById('hamburger');
            const navLinks = document.getElementById('navLinks');
            
            hamburger.addEventListener('click', () => {
                hamburger.classList.toggle('active');
                navLinks.classList.toggle('active');
                document.body.style.overflow = navLinks.classList.contains('active') ? 'hidden' : '';
            });
            
            // Close menu when clicking on a link
            document.querySelectorAll('.nav-item').forEach(link => {
                link.addEventListener('click', () => {
                    hamburger.classList.remove('active');
                    navLinks.classList.remove('active');
                    document.body.style.overflow = '';
                });
            });
            
            // Navbar scroll effect
            const navbar = document.getElementById('navbar');
            window.addEventListener('scroll', () => {
                if (window.scrollY > 50) {
                    navbar.classList.add('scrolled');
                } else {
                    navbar.classList.remove('scrolled');
                }
            });
            
            // Netlify Identity and CMS Integration
            if (window.netlifyIdentity) {
                window.netlifyIdentity.on("init", user => {
                    if (!user) {
                        window.netlifyIdentity.on("login", () => {
                            document.location.href = "/admin/";
                        });
                    }
                });
                
                // Check if user is logged in
                const currentUser = netlifyIdentity.currentUser();
                if (currentUser) {
                    document.getElementById('cmsAdminBtn').style.display = 'flex';
                }
                
                // Listen for login events
                netlifyIdentity.on('login', user => {
                    document.getElementById('cmsAdminBtn').style.display = 'flex';
                });
                
                // Listen for logout events
                netlifyIdentity.on('logout', () => {
                    document.getElementById('cmsAdminBtn').style.display = 'none';
                });
            }

            // Form submission handling
            const contactForm = document.querySelector('.contact-form form');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Here you would typically send the form data to a server
                    // For now, we'll just show an alert
                    alert('Thank you for your message! We will get back to you soon.');
                    this.reset();
                });
            }
        });
    </script>
</body>
</html>
